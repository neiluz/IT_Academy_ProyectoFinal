# -*- coding: utf-8 -*-
"""Notebook 7.3a Modelaje DL - Polarity Vader.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/17wmMP_C5dJfQJlufNlYwlWS8ThqD_2-1

<div style="background-color: #1DA1F2; padding: 20px;"><b><h1> Descifrando el lenguaje emocional en Twitter: Un análisis predictivo basado en aprendizaje automático. </h1></b></div>

**Autor**: Neivys Luz González Gómez

La identificación de emociones es una tarea fundamental en el campo del procesamiento de lenguaje natural, que se enfoca en clasificar textos según su tono emocional. A pesar de que el objetivo es identificar una amplia variedad de emociones humanas, la mayoría de los conjuntos de datos disponibles se limitan a las polaridades positiva, negativa y, en ocasiones, neutral.

Detectar emociones a partir de textos es un reto complejo en el procesamiento del lenguaje natural, ya que se trata de un problema de clasificación multiclase y, en muchas ocasiones, no hay suficientes datos etiquetados disponibles. Sin embargo, este conjunto de datos etiquetado proporciona la oportunidad de aplicar diversas técnicas de análisis exploratorio y modelado para entender mejor la dinámica emocional en las redes sociales y mejorar la capacidad de detección en tiempo real.

El conjunto de datos de emociones se obtiene a partir de mensajes en inglés de Twitter y contiene seis emociones básicas: neutralidad, preocupación, felicidad, tristeza, amor, sorpresa, diversión, alivio, odio, vacío, entusiasmo y aburrimiento. Este conjunto de datos ofrece una variedad más amplia de emociones humanas, lo que permite el entrenamiento y la evaluación de modelos de análisis de sentimientos con mayor precisión y exhaustividad.

<div class="alert alert-info alert-info"><b><h3>Objetivo General</h3></b>
    
**Desarrollar un modelo que permita detectar emociones en los tweets y analizar patrones en el lenguaje utilizado en Twitter para ayudar en la detección temprana de trastornos emocionales como la depresión, la ansiedad, entre otros.**
</div>

---

# Notebook N° 7.3a: Modelo Deep Learning con el modelo pre entrenado Bert - Polarity Vader

<div class="alert alert-block alert-warning">
<b><h1>Descripción de las Variables</h1></b> 
</div>

Se dispone de un conjunto de datos proveniente de data.world, una plataforma que proporciona acceso a conjuntos de datos públicos. Este dataset consiste en una colección de tweets etiquetados con la emoción que expresan. Contiene cuatro columnas que incluyen el identificador del tweet, el sentimiento expresado, el autor y el contenido del tweet. En total, se tienen 40,000 registros con anotaciones para 13 emociones distintas.

![Notebook.jpg](data:image/jpeg;base64,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)

En este notebook se presenta la evaluación del modelo pre-entrenado Bert en la tarea de clasificación de sentimientos en tweets. Para ello, se utilizó un dataset preprocesado en el que las emociones originales fueron transformadas mediante el análisis de sentimiento de Polaridad de Varder.

El modelo implementado es un clasificador de texto basado en técnicas de aprendizaje profundo (deep learning) que utiliza el modelo pre-entrenado BERT para clasificar los tweets en tres categorías: positivo, negativo y neutral. BERT, acrónimo de Bidirectional Encoder Representations from Transformers, es un modelo de lenguaje basado en Transformers que fue pre-entrenado en enormes cantidades de datos textuales, lo que le permite capturar patrones complejos en el lenguaje. Al utilizar un modelo pre-entrenado como BERT, se pueden obtener mejores resultados con menos datos de entrenamiento y menos tiempo de entrenamiento.
"""

from google.colab import drive
drive.mount('/content/drive')

pip install transformers

"""---"""

# general purpose packages
import numpy as np
import pandas as pd
import tensorflow as tf
import matplotlib.pyplot as plt
import seaborn as sns

#data processing
import re, string
import nltk

from sklearn import preprocessing
from imblearn.over_sampling import RandomOverSampler
from sklearn.model_selection import train_test_split


#transformers
from transformers import BertTokenizerFast
from transformers import TFBertModel
from transformers import RobertaTokenizerFast
from transformers import TFRobertaModel

#keras
import tensorflow as tf
from tensorflow import keras

#metrics
from sklearn.metrics import accuracy_score, f1_score
from sklearn.metrics import classification_report, confusion_matrix

#set seed for reproducibility
seed=42

import warnings
warnings.filterwarnings('ignore')

device_name = tf.test.gpu_device_name()
if device_name != '/device:GPU:0':
  raise SystemError('GPU device not found')
print('Found GPU at: {}'.format(device_name))

"""---

<div class="alert alert-block alert-info">
<b><h2> Cargar Dataset.</h2></b> 
</div>
"""

df3 = pd.read_pickle('/content/dataset3.pickle')

df3

"""## 1. Preparación del Dataset"""

df3.info()

"""### 1.1 Verificar nulos y NaM"""

df3.isnull().sum()

df3.isna().sum()

"""* **Longitud del texto**

Se crea una columna para alojar la longitud del texto limpio
"""

text_len = []
for text in df3.content :
    tweet_len = len(text.split())
    text_len.append(tweet_len)

df3['text_len'] = text_len

df3.head()

df3.info()

"""### 1.3 Limpieza más profunda

Se realizará si se puede reañizar una limpieza adicional verificando la versión tokenizadora de las oraciones.

* **Primero, importar el tokenizador BERT.**
"""

tokenizer = BertTokenizerFast.from_pretrained('bert-base-uncased')

token_lens = []

for txt in df3['content'].values:
    tokens = tokenizer.encode(txt, max_length=512, truncation=True)
    token_lens.append(len(tokens))
    
max_len=np.max(token_lens)

print(f"Maxima logitud de las oraciones TOKENIZED: {max_len}")

df3['token_lens'] = token_lens

df3.head()

df3.info()

"""<h3>Observaciones:</h3>

   *  Se puede observar que el data set no tiene valores nulos o NaN. 
   *  Se puede observar que el data set no tiene valores duplicados.  
   *  Al tokenizar el texto, se observa que aumentan la cantidad de palabras en la oracion o tweet.

## 2. Modelo

### 2.1 Se define el target y la feature
"""

# Se define el target y la feature
X = df3['content'].values
y = df3['polarity_vader'].values

X.shape

y.shape

# Separamos los datos en conjuntos de entrenamiento y prueba
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.15, random_state=42)

print("X_train shape:", X_train.shape)
print("X_test shape:", X_test.shape)
print("y_train shape:", y_train.shape)
print("y_test shape:", y_test.shape)

# Dividir los datos de entrenamiento en entrenamiento y validación (70% - 15%)
X_train, X_val, y_train, y_val = train_test_split(X_train, y_train, test_size=0.15, random_state=42)

print("X_train shape:", X_train.shape)
print("X_test shape:", X_test.shape)
print("X_val shape:", X_val.shape)
print("y_train shape:", y_train.shape)
print("y_test shape:", y_test.shape)
print("y_val shape:", y_val.shape)

X_train1 = X_train1.reset_index()
X_val = X_val.reset_index()
X_test = X_test.reset_index()

print("X_train1 shape:", X_train1.shape)
print("X_test shape:", X_test.shape)
print("X_val shape:", X_val.shape)
print("y_train1 shape:", y_train1.shape)
print("y_test shape:", y_test.shape)
print("y_val shape:", y_val.shape)

# Reset del índice en y_train1, y_val y y_test
y_train1 = y_train1.reshape((-1,1))
y_val = y_val.reshape((-1,1))
y_test = y_test.reshape((-1,1))

print(len(y_train1))
print(len(y_val))
print(len(y_test))

"""### 2.2 One hot encoding"""

y_train_le = y_train.copy()
y_valid_le = y_val.copy()
y_test_le = y_test.copy()

print("Shape de y_train:", y_train_le.shape)
print("Shape de y_val:", y_valid_le.shape)
print("Shape de y_test:", y_test_le.shape)

ohe = preprocessing.OneHotEncoder()
y_train = ohe.fit_transform(np.array(y_train_le).reshape(-1, 1)).toarray()
y_val = ohe.transform(np.array(y_valid_le).reshape(-1, 1)).toarray()
y_test = ohe.transform(np.array(y_test_le).reshape(-1, 1)).toarray()

print("Shape de y_train:", y_train.shape)
print("Shape de y_val:", y_val.shape)
print("Shape de y_test:", y_test.shape)

"""## 3.Modelo BERT

BERT (Bidirectional Encoder Representations from Transformers) es un modelo de lenguaje basado en la arquitectura Transformer, que utiliza un enfoque bidireccional para el procesamiento de texto, lo que significa que considera el contexto completo de la oración en ambas direcciones para generar representaciones de palabras más precisas y contextualizadas.

El modelo BERT es pre-entrenado en grandes corpus de datos y luego se puede ajustar o fine-tunear para tareas específicas, como la clasificación de texto, la extracción de información o la generación de lenguaje natural. BERT ha establecido nuevos estándares de rendimiento en varias tareas de procesamiento de lenguaje natural y es ampliamente utilizado en la investigación y la industria.

### 3.1 Tokenizar el conjunto de datos
"""

max_len = 128

def tokenize(data,max_lenmax_len) :
    input_ids = []
    attention_masks = []
    for i in range(len(data)):
        encoded = tokenizer.encode_plus(
            data[i],
            add_special_tokens=True,
            max_length=max_len,
            padding='max_length',
            return_attention_mask=True
        )
        input_ids.append(encoded['input_ids'])
        attention_masks.append(encoded['attention_mask'])
    return np.array(input_ids),np.array(attention_masks)

"""* Luego, aplica la función tokenizadora a los conjuntos de tren, validación y prueba."""

train_input_ids, train_attention_masks = tokenize(X_train, max_len)
val_input_ids, val_attention_masks = tokenize(X_val, max_len)
test_input_ids, test_attention_masks = tokenize(X_test, max_len)

print("train_input_ids length:", len(train_input_ids))
print("train_attention_masks length:", len(train_attention_masks))
print("val_input_ids length:", len(val_input_ids))
print("val_attention_masks length:", len(val_attention_masks))
print("test_input_ids length:", len(test_input_ids))
print("test_attention_masks length:", len(test_attention_masks))

"""### 3.2 Creación  del modelo"""

# importar el modelo BERT de la biblioteca preentrenada de Hugging face
bert_model = TFBertModel.from_pretrained('bert-base-uncased', num_labels=3)

from tensorflow.keras.utils import plot_model

def create_model(bert_model, max_len=max_len):
    # Parámetros del optimizador
    opt = tf.keras.optimizers.Adam(learning_rate=1e-5, beta_1=0.9, beta_2=0.999)

    # Función de pérdida y métrica de precisión
    loss = tf.keras.losses.CategoricalCrossentropy()
    accuracy = tf.keras.metrics.CategoricalAccuracy()

    # Capa de entrada para los ids de las palabras y las máscaras de atención
    input_ids = tf.keras.Input(shape=(max_len,), dtype='int32')
    attention_masks = tf.keras.Input(shape=(max_len,), dtype='int32')

    # Capa de embeddings usando el modelo BERT pre-entrenado
    embeddings = bert_model([input_ids, attention_masks])[1]

    # Capa oculta completamente conectada con 256 unidades y función de activación relu
    hidden_layer = tf.keras.layers.Dense(256, activation='relu')(embeddings)

    # Agregar una capa de abandono con una tasa de abandono del 0.5
    dropout = tf.keras.layers.Dropout(0.5)(hidden_layer)

    # Capa de salida con activación softmax
    output = tf.keras.layers.Dense(3, activation='softmax')(dropout)

    # Creación del modelo con las capas de entrada, embeddings, capa oculta, salida y la capa de abandono
    model = tf.keras.models.Model(inputs=[input_ids, attention_masks], outputs=output)

    # Compilación del modelo con optimizador, función de pérdida y métrica de precisión
    model.compile(optimizer=opt, loss=loss, metrics=[accuracy])

    # Visualización del modelo
    plot_model(model, to_file='modelo_clasificacion_tweets.png', show_shapes=True)

    return model

model = create_model(bert_model, max_len)
model.summary()

from PIL import Image

# Visualiza la arquitectura del modelo y guarda la imagen
plot_model(model, to_file='model.png', show_shapes=True, show_layer_names=True)

# Muestra la imagen en la pantalla
img = Image.open('model.png')
img.show()

"""### 3.2 Entrenar modelo"""

# ajustar el transformador BERT
history_bert = model.fit([train_input_ids, train_attention_masks], y_train, validation_data=([val_input_ids, val_attention_masks], y_val), epochs=4, batch_size=32)

"""* **Precisión y la pérdida a lo largo del tiempo**"""

history_dict = history_bert.history
print(history_dict.keys())

acc = history_dict['categorical_accuracy']
val_acc = history_dict['val_categorical_accuracy']
loss = history_dict['loss']
val_loss = history_dict['val_loss']

epochs = range(1, len(acc) + 1)
fig = plt.figure(figsize=(10, 6))
fig.tight_layout()

plt.subplot(2, 1, 1)
# r is for "solid red line"
plt.plot(epochs, loss, 'r', label='Training loss')
# b is for "solid blue line"
plt.plot(epochs, val_loss, 'b', label='Validation loss')
plt.title('Training and validation loss')
# plt.xlabel('Epochs')
plt.ylabel('Loss')
plt.legend()

plt.subplot(2, 1, 2)
plt.plot(epochs, acc, 'r', label='Training acc')
plt.plot(epochs, val_acc, 'b', label='Validation acc')
plt.title('Training and validation accuracy')
plt.xlabel('Epochs')
plt.ylabel('Accuracy')
plt.legend(loc='lower right')

"""### 3.4. Predecir y evaluar el modelo """

result_bert = model.predict([test_input_ids,test_attention_masks])

def conf_matrix(y, y_pred, title):
    fig, ax =plt.subplots(figsize=(5,5))
    labels=['Negative', 'Neutral', 'Positive']
    ax=sns.heatmap(confusion_matrix(y, y_pred), annot=True, cmap="Blues", fmt='g', cbar=False, annot_kws={"size":25})
    plt.title(title, fontsize=20)
    ax.xaxis.set_ticklabels(labels, fontsize=17) 
    ax.yaxis.set_ticklabels(labels, fontsize=17)
    ax.set_ylabel('Test', fontsize=20)
    ax.set_xlabel('Predicted', fontsize=20)
    plt.show()

y_pred_bert =  np.zeros_like(result_bert)
y_pred_bert[np.arange(len(y_pred_bert)), result_bert.argmax(1)] = 1

"""* **Evaluación del modelo**"""

conf_matrix(y_test.argmax(1), y_pred_bert.argmax(1),'BERT Sentiment Analysis\nConfusion Matrix')

print('\tClassification Report for BERT:\n\n',classification_report(y_test,y_pred_bert, target_names=['Negative', 'Neutral', 'Positive']))

"""## 5. Observaciones generales

Algunas observaciones que pueden extraerse de los resultados del modelo BERT son:

* Este modelo es una red neuronal que utiliza la arquitectura BERT para realizar una tarea de clasificación de textos. La entrada del modelo son dos secuencias de texto (input_1 y input_2) de longitud máxima 128, y la salida del modelo es una predicción de las tres categorías posibles (Negative, Neutral, Positive). El modelo utiliza una capa densa y una capa de dropout para mejorar la generalización y evitar el overfitting. El modelo tiene un total de 109,679,875 parámetros, que se pueden entrenar para adaptar el modelo a la tarea específica.

* El modelo tiene un rendimiento general alto en todas las clases de sentimientos, con un F1-score promedio del 93% en el conjunto de datos de prueba.

* La precisión y el recall son altos para las tres clases de sentimientos, lo que indica que el modelo es capaz de identificar correctamente las emociones en los tweets.

* La clase "Negative" tiene una precisión de 0.89 y un recall de 0.92, mientras que las otras clases tienen una precisión y recall más altos. Esto significa que el modelo tiende a clasificar menos instancias como "Negative" en comparación con las otras dos clases, lo que puede indicar una posible falta de datos de entrenamiento o desbalanceo de clases en el conjunto de datos.
"""